<%- include('partials/header') %>

<style>
    .dashboard-card {
        background-color: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
        border-radius: 1rem;
        box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        margin-bottom: 1.5rem;
        transition: transform 0.3s, box-shadow 0.3s;
    }
    .dashboard-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    }
    .main-container {
        background-color: rgba(255, 255, 255, 0.85);
        border-radius: 1rem;
        padding: 2rem;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
        backdrop-filter: blur(10px);
        position: relative;
        z-index: 1;
    }
    .welcome-header {
        background: linear-gradient(135deg, #ff7043 0%, #ffab91 100%);
        color: white;
        border-radius: 1rem;
        padding: 2rem;
        margin-bottom: 2rem;
        text-align: center;
        box-shadow: 0 4px 16px rgba(255, 112, 67, 0.3);
    }
    .quick-action-card {
        background: linear-gradient(135deg, #ffb347 0%, #ffcc33 100%);
        color: white;
        border: none;
        border-radius: 1rem;
        padding: 1.5rem;
        text-align: center;
        transition: all 0.3s;
        cursor: pointer;
        text-decoration: none;
        display: block;
        height: 100%;
    }
    .quick-action-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 24px rgba(255, 179, 71, 0.4);
        color: white;
        text-decoration: none;
    }
    .quick-action-icon {
        font-size: 2.5rem;
        margin-bottom: 1rem;
        display: block;
    }
    .stats-mini {
        background-color: rgba(255, 248, 225, 0.9);
        border-radius: 0.5rem;
        padding: 1rem;
        text-align: center;
        margin-bottom: 0.5rem;
    }
    .stats-number {
        font-size: 1.5rem;
        font-weight: bold;
        color: #ff7043;
        margin-bottom: 0.25rem;
    }
    .stats-label {
        font-size: 0.85rem;
        color: #666;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    .recent-recipe-card {
        border-radius: 0.75rem;
        overflow: hidden;
        transition: transform 0.3s;
        background-color: rgba(255, 255, 255, 0.95);
        border: 1px solid rgba(255, 112, 67, 0.1);
    }
    .recent-recipe-card:hover {
        transform: translateY(-3px);
    }
    .recipe-thumbnail {
        height: 120px;
        object-fit: cover;
    }
    .section-title {
        color: #ff7043;
        text-shadow: 1px 1px 4px rgba(255, 255, 255, 0.8);
        font-weight: bold;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }
    .activity-item {
        padding: 0.75rem;
        border-left: 3px solid #ffb347;
        background-color: rgba(255, 248, 225, 0.7);
        border-radius: 0 0.5rem 0.5rem 0;
        margin-bottom: 0.5rem;
    }
    .activity-time {
        font-size: 0.8rem;
        color: #666;
    }
    .discovery-section {
        background: linear-gradient(135deg, rgba(255, 112, 67, 0.1) 0%, rgba(255, 171, 145, 0.1) 100%);
        border-radius: 1rem;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
    }
</style>

<div class="container mt-4 mb-5">
    <div class="main-container">
        <!-- Welcome Header -->
        <div class="welcome-header">
            <h1><i class="bi bi-house-heart"></i> Welcome back, <%= user.username %>!</h1>
            <p class="mb-0">Ready to discover and share amazing recipes today?</p>
        </div>

        <!-- Quick Stats Row -->
        <div class="row mb-4">
            <div class="col-3">
                <div class="stats-mini">
                    <div class="stats-number"><%= recipes.length %></div>
                    <div class="stats-label">My Recipes</div>
                </div>
            </div>
            <div class="col-3">
                <div class="stats-mini">
                    <div class="stats-number"><%= favoriteCount || 0 %></div>
                    <div class="stats-label">Favorites</div>
                </div>
            </div>
            <div class="col-3">
                <div class="stats-mini">
                    <div class="stats-number"><%= viewCount || 0 %></div>
                    <div class="stats-label">Recipe Views</div>
                </div>
            </div>
            <div class="col-3">
                <div class="stats-mini">
                    <div class="stats-number">4.8</div>
                    <div class="stats-label">Avg Rating</div>
                </div>
            </div>
        </div>

        <div class="row">
            <!-- Left Column: Quick Actions & Recent Activity -->
            <div class="col-md-8">
                <!-- Quick Actions -->
                <div class="dashboard-card p-3">
                    <h4 class="section-title">
                        <i class="bi bi-lightning-charge"></i> Quick Actions
                    </h4>
                    <div class="row g-3">
                        <div class="col-md-4">
                            <a href="/recipes/new" class="quick-action-card">
                                <i class="bi bi-plus-circle quick-action-icon"></i>
                                <h6>Create Recipe</h6>
                                <small>Share your culinary creation</small>
                            </a>
                        </div>
                        <div class="col-md-4">
                            <a href="/recipes/search" class="quick-action-card">
                                <i class="bi bi-search quick-action-icon"></i>
                                <h6>Find Recipes</h6>
                                <small>AI-powered recipe discovery</small>
                            </a>
                        </div>
                        <div class="col-md-4">
                            <a href="/recipes" class="quick-action-card">
                                <i class="bi bi-collection quick-action-icon"></i>
                                <h6>Browse All</h6>
                                <small>Explore the recipe collection</small>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="dashboard-card p-3">
                    <h4 class="section-title">
                        <i class="bi bi-clock-history"></i> Recent Activity
                    </h4>
                    <div class="activity-item">
                        <div><strong>Created</strong> "<%= recipes.length > 0 ? recipes[0].title : 'Your First Recipe' %>"</div>
                        <div class="activity-time">2 hours ago</div>
                    </div>
                    <div class="activity-item">
                        <div><strong>Favorited</strong> "Spicy Thai Curry"</div>
                        <div class="activity-time">1 day ago</div>
                    </div>
                    <div class="activity-item">
                        <div><strong>Searched</strong> for "vegetarian pasta"</div>
                        <div class="activity-time">2 days ago</div>
                    </div>
                    <div class="text-center mt-3">
                        <a href="/activity" class="btn btn-outline-secondary btn-sm">View All Activity</a>
                    </div>
                </div>

                <!-- Recipe Discovery -->
                <div class="discovery-section">
                    <h4 class="section-title">
                        <i class="bi bi-compass"></i> Discover New Recipes
                    </h4>
                    <p class="text-muted mb-3">Based on your preferences and favorites</p>
                    <div class="row g-2">
                        <div class="col-4">
                            <a href="/recipes/search?query=italian" class="btn btn-outline-primary btn-sm w-100">
                                <i class="bi bi-geo-alt"></i> Italian
                            </a>
                        </div>
                        <div class="col-4">
                            <a href="/recipes/search?query=quick meals" class="btn btn-outline-success btn-sm w-100">
                                <i class="bi bi-clock"></i> Quick Meals
                            </a>
                        </div>
                        <div class="col-4">
                            <a href="/recipes/search?query=healthy" class="btn btn-outline-info btn-sm w-100">
                                <i class="bi bi-heart-pulse"></i> Healthy
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column: Recent Recipes & Favorites -->
            <div class="col-md-4">
                <!-- My Recent Recipes -->
                <div class="dashboard-card p-3">
                    <h5 class="section-title">
                        <i class="bi bi-journal-plus"></i> My Recent Recipes
                    </h5>
                    <% if (recipes.length === 0) { %>
                        <div class="text-center py-4">
                            <i class="bi bi-journal-plus" style="font-size: 2rem; color: #ffb347; margin-bottom: 0.5rem;"></i>
                            <p class="text-muted small">No recipes yet</p>
                            <a href="/recipes/new" class="btn btn-main btn-sm">Create First Recipe</a>
                        </div>
                    <% } else { %>
                        <% recipes.slice(0, 3).forEach(recipe => { %>
                            <div class="card recent-recipe-card mb-2">
                                <div class="row g-0">
                                    <div class="col-4">
                                        <img src="https://source.unsplash.com/random/120x120/?<%= encodeURIComponent(recipe.title.split(' ')[0]) %>,food" 
                                             class="img-fluid recipe-thumbnail" alt="<%= recipe.title %>">
                                    </div>
                                    <div class="col-8">
                                        <div class="card-body p-2">
                                            <h6 class="card-title mb-1" style="font-size: 0.9rem;"><%= recipe.title %></h6>
                                            <p class="card-text small text-muted" style="font-size: 0.75rem;">
                                                <%= recipe.description ? recipe.description.substring(0, 50) + '...' : 'No description' %>
                                            </p>
                                            <a href="/recipes/<%= recipe.id %>?page=dashboard" class="btn btn-outline-primary btn-sm" style="font-size: 0.7rem;">
                                                View
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        <% }) %>
                        <div class="text-center mt-2">
                            <a href="/profile" class="btn btn-outline-secondary btn-sm">View All My Recipes</a>
                        </div>
                    <% } %>
                </div>

                <!-- Quick Links -->
                <div class="dashboard-card p-3">
                    <h5 class="section-title">
                        <i class="bi bi-bookmark-star"></i> Quick Links
                    </h5>
                    <div class="d-grid gap-2">
                        <a href="/favorites" class="btn btn-outline-danger btn-sm">
                            <i class="bi bi-heart-fill"></i> My Favorites
                        </a>
                        <a href="/users" class="btn btn-outline-info btn-sm">
                            <i class="bi bi-people"></i> Discover Chefs
                        </a>
                        <a href="/profile/edit" class="btn btn-outline-secondary btn-sm">
                            <i class="bi bi-person-gear"></i> Edit Profile
                        </a>
                    </div>
                </div>

                <!-- Daily Tip -->
                <div class="dashboard-card p-3">
                    <h5 class="section-title">
                        <i class="bi bi-lightbulb"></i> Chef's Tip
                    </h5>
                    <div class="text-center">
                        <p class="small text-muted mb-2">ðŸ’¡ <strong>Today's Tip:</strong></p>
                        <p class="small">Add a pinch of salt to your coffee grounds before brewing to reduce bitterness and enhance flavor!</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <div class="text-center mt-4 pt-3" style="border-top: 1px solid rgba(255, 112, 67, 0.2);">
            <a href="/" class="btn btn-outline-secondary me-2">
                <i class="bi bi-house"></i> Home
            </a>
            <a href="/profile" class="btn btn-outline-main">
                <i class="bi bi-person-circle"></i> My Profile
            </a>
        </div>
    </div>
</div>

<%- include('partials/footer') %>
